# Security: Block script execution in uploads directory
# Hanya izinkan akses file dokumen PDF

<FilesMatch "\.(php|phtml|php3|php4|php5|php7|phps|cgi|pl|py|jsp|asp|sh|shtml)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Allow PDF and block executable scripts (compatible with Apache 2.4+ and 2.2)
<IfModule mod_authz_core.c>
    <FilesMatch "\.pdf$">
        Require all granted
    </FilesMatch>

    <FilesMatch "\.(php|phtml|php[0-9]|phps|cgi|pl|py|jsp|asp|sh|shtml)$">
        Require all denied
    </FilesMatch>
</IfModule>

<IfModule !mod_authz_core.c>
    <FilesMatch "\.pdf$">
        Order allow,deny
        Allow from all
    </FilesMatch>

    <FilesMatch "\.(php|phtml|php[0-9]|phps|cgi|pl|py|jsp|asp|sh|shtml)$">
        Order allow,deny
        Deny from all
    </FilesMatch>
</IfModule>

# Disable directory listing
Options -Indexes

# Prevent accessing .htaccess and .htpasswd files
<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files>
